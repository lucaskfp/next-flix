import HomeListGenres from "components/HomeListGenres";
import HomeLists from "components/HomeLists";
import Logo from "components/Logo";
import fetcher from "constants/fetcher";
import tmdbConfigs from "constants/tmdbConfigs";
import Head from "next/head";

export default function Home({
  movies,
  series,
  tmdnConfigs,
  movieGenres,
  serieGenres,
  nowPlaying,
}) {
  return (
    <>
      <Head>
        <title>Next Flix</title>
        <meta name="description" content="Generated by create next app" />
      </Head>

      <header className="py-2 bg-white shadow lg:hidden">
        <Logo className="mx-auto " />
      </header>

      <div className="py-10">
        <section className="mb-10 lg:mb-20 container px-0">
          <h2 className="mb-4 text-xl lg:text-2xl font-bold <lg:px-4">
            Trending Filmes
          </h2>

          <div className="flex gap-4 md:gap-8 ">
            <HomeLists type="movie" tmdnConfigs={tmdnConfigs} data={movies} />

            <div className="border <lg:hidden"></div>

            <div className="<lg:hidden ">
              <div className="sticky top-4">
                <HomeListGenres list={movieGenres} />
              </div>
            </div>
          </div>
        </section>

        <section className="mb-10 lg:mb-20 container px-0">
          <h2 className="mb-4 text-xl lg:text-2xl font-bold <lg:px-4">
            Nos Cinemas
          </h2>

          <div className="flex gap-4 md:gap-8 ">
            <HomeLists
              type="movie"
              tmdnConfigs={tmdnConfigs}
              data={nowPlaying}
            />
          </div>
        </section>

        <section className="container px-0">
          <h2 className="mb-4 text-xl lg:text-2xl font-bold <lg:px-4">
            Trending SÃ©ries
          </h2>

          <div className="flex gap-4 md:gap-8 ">
            <HomeLists type="tv" tmdnConfigs={tmdnConfigs} data={series} />

            <div className="border <lg:hidden"></div>

            <div className="<lg:hidden ">
              <div className="sticky top-4">
                <HomeListGenres list={serieGenres} />
              </div>
            </div>
          </div>
        </section>
      </div>
    </>
  );
}

export async function getStaticProps() {
  const { results: movies } = await fetcher("trending/movie/day");
  const { results: series } = await fetcher("trending/tv/day");
  const { genres: movieGenres } = await fetcher("genre/movie/list");
  const { genres: serieGenres } = await fetcher("genre/tv/list");
  const { results: nowPlaying } = await fetcher(
    "movie/now_playing",
    "region=BR"
  );
  const tmdnConfigs = await tmdbConfigs();

  return {
    props: {
      movies,
      series,
      tmdnConfigs,
      movieGenres,
      serieGenres,
      nowPlaying,
    },
    revalidate: 14400,
  };
}
